<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:fragment="head">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–µ—Ä–≤–∏—Å –ø–æ–≥–æ–¥—ã</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/fragments/header.css}"/>
    <link rel="stylesheet" th:href="@{/css/main-page.css}"/>
</head>

<body>
<div class="d-flex flex-column min-vh-100">

    <!-- Header -->
    <div th:replace="~{fragments/header :: header(login=${login}, isAuthenticated=${isAuthenticated})}"></div>

    <!-- Main Content -->
    <main class="container my-5 flex-grow-1">
        <div th:if="${error}" class="alert alert-danger text-center" th:text="${error}"></div>

        <!-- Locations List -->
        <div class="row" th:if="${isAuthenticated}">
            <div class="col-12">
                <h2 class="h4 mb-4">–ú–æ–∏ –ª–æ–∫–∞—Ü–∏–∏</h2>

                <div th:if="${locations != null and !locations.empty}" class="row g-4">

                    <div th:each="location : ${locations}" class="col-md-6 col-lg-4">
                        <div class="card shadow-sm rounded-4 location-card h-100 border-0">

                            <div class="card-body p-4 d-flex flex-column justify-content-between">

                                <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∏ —Å—Ç—Ä–∞–Ω–∞ -->
                                <div class="mb-3">
                                    <h5 class="card-title mb-1" th:text="${location.name}">–ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞</h5>
                                    <p class="text-muted mb-2" th:text="${location.country}">–°—Ç—Ä–∞–Ω–∞</p>
                                </div>

                                <!-- –ü–æ–≥–æ–¥–∞ -->
                                <div class="weather-info mb-3">
                                    <p class="mb-1">
                                        –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: <strong th:text="${location.temp != null ? location.temp + '¬∞C' : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}">24¬∞C</strong>
                                    </p>
                                    <p class="mb-1 text-muted small" th:if="${location.feelsLike != null}">
                                        –û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫: <span th:text="${location.feelsLike + '¬∞C'}">22¬∞C</span>
                                    </p>
                                </div>

                                <!-- –í—Ä–µ–º—è —Ä–∞—Å—Å–≤–µ—Ç–∞ –∏ –∑–∞–∫–∞—Ç–∞ -->
                                <div class="d-flex justify-content-between text-muted small mb-3">
                                    <div>
                                        <span class="me-1">üåÖ</span>
                                        <span th:text="${location.sunrise}">06:00</span>
                                    </div>
                                    <div>
                                        <span class="me-1">üåá</span>
                                        <span th:text="${location.sunset}">20:45</span>
                                    </div>
                                </div>

                                <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
                                <form th:action="@{/delete}" method="post" class="text-end mt-auto">
                                    <!-- –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç -->
                                    <input type="hidden" name="lat" th:value="${location.coord.lat}" />
                                    <input type="hidden" name="lon" th:value="${location.coord.lon}" />
                                    <button type="submit" class="btn btn-sm btn-outline-danger rounded-pill">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                             fill="currentColor" class="bi bi-trash me-1" viewBox="0 0 16 16">
                                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3
                            .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                                            <path fill-rule="evenodd"
                                                  d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0
                                  0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1
                                  1h3.5a1 1 0 0 1 1 1v1zM4.118 4
                                  4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0
                                  0 1-1V4.059L11.882 4H4.118zM2.5
                                  3V2h11v1h-11z"/>
                                        </svg>
                                        –£–¥–∞–ª–∏—Ç—å
                                    </button>
                                </form>

                            </div>
                        </div>
                    </div>

                </div>

                <div th:if="${locations == null or locations.empty}" class="alert alert-info">
                    –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π. –ù–∞—á–Ω–∏—Ç–µ —Å –ø–æ–∏—Å–∫–∞ –≥–æ—Ä–æ–¥–∞ –≤—ã—à–µ.
                </div>
            </div>
        </div>

        <!-- Guest Message -->
        <div th:unless="${isAuthenticated}" class="text-center py-5">

            <div class="card p-5 bg-light">
                <h2 class="h4 mb-4">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –°–µ—Ä–≤–∏—Å –ø–æ–≥–æ–¥—ã!</h2>
                <p class="mb-4">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å.</p>
                <div>
                    <a th:href="@{/sign-in}" class="btn btn-primary me-2">–í–æ–π—Ç–∏</a>
                    <a th:href="@{/sign-up}" class="btn btn-outline-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-4 bg-light mt-auto">
        <div class="container text-center">
            <span class="text-muted">¬© 2025 –ü–æ–≥–æ–¥–∞</span>
        </div>
    </footer>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>